{{#let (changeset @episode this.EpisodeValidations) as |changeset|}}
  <Ui::ChangesetForm
    @containerClass="page-spacing"
    @changeset={{changeset}}
    @onError={{this.onError}}
    @onSubmit={{this.onSubmit}}
    as |Form|
  >
    <h5 class="italic text-xs">(episode update form)</h5>
    <section class="my-2">
      <div class="flex justify-start italic text-sm my-1">
        <span>
          {{t "profile.my-shows.form.air-date"}}
        </span>
        <span>
          {{format-day @episode.start}}
          -
          {{format-time @episode.start}}
        </span>
      </div>
      <Form.Input
        @label={{t "profile.my-shows.form.title"}}
        @fieldName="title"
        @containerClass="mb-2 flex justify-between"
      />
      <Form.Textarea
        @label={{t "profile.my-shows.form.description"}}
        @fieldName="description"
        @containerClass="mb-2 flex justify-between"
        @size="lg"
        @value={{changeset.description}}
        rows="5"
        cols="35"
      />
      <LabelsSelect
        class="my-2 flex justify-between"
        @changeset={{changeset}}
      />
      {{! episode artwork uploader }}
      <div class="flex justify-start mb-4">

        <label class="align-top" for="show-artwork">
          {{t "profile.my-shows.form.artwork"}}
        </label>
        <input
          class="text-df-yellow semibold border-dashed"
          id="showArtwork"
          name="showArtwork"
          type="file"
          accept="image/*"
          {{on "change" this.updateFile}}
        />
        {{#if @episode.isNew}}
          {{#if changeset.image}}
            <img
              alt="artwork"
              width="300"
              height="300"
              src="{{changeset.image}}"
            />
          {{/if}}
        {{else}}
          {{#if changeset.thumbImageUrl}}
            <img
              alt="artwork"
              width="300"
              height="300"
              src="{{changeset.thumbImageUrl}}"
            />
          {{/if}}
        {{/if}}

      </div>
      {{#if @episode.airDatePassed}}
        <div class="">

          <MyShows::RecordingSelector @changeset={{changeset}} />
          <div class="my-2 flex justify-between">

            <label for="archive-status">
              {{t "profile.my-shows.form.archive-status"}}
            </label>
            <select
              id="archive-status"
              name="archive-status"
              {{on "change" (pick "target.value" (set changeset "status"))}}
            >
              {{#each-in this.statusOptions as |key val|}}
                <option value="{{val}}" selected={{eq changeset.status val}}>
                  {{key}}
                </option>
              {{/each-in}}
            </select>
          </div>
          <div class="my-2 py-2 border-2 border-red-400 border-dashed">
            <Form.Input
              @label={{t "profile.my-shows.form.youtube-link"}}
              @fieldName="youtubeLink"
              @containerClass="mb-2 flex justify-between"
            />
            <Form.Input
              @label={{t "profile.my-shows.form.mixcloud-link"}}
              @fieldName="mixcloudLink"
              @containerClass="mb-2 flex justify-between"
            />
            <Form.Input
              @label={{t "profile.my-shows.form.soundcloud-link"}}
              @fieldName="soundcloudLink"
              @containerClass="mb-2 flex justify-between"
            />
          </div>
        </div>
      {{else}}
        {{! airdate has *not* passed; its an upcoming show }}
        <div>
          <TimePicker
            @label="Start time"
            @property="start"
            @changeset={{changeset}}
            @onChange={{this.setEndAfterStart}}
          />
          <TimePicker
            @label="Duration"
            @property="end"
            @changeset={{changeset}}
            @startTime={{changeset.start}}
          />
        </div>
        <h4>
          {{t "profile.my-shows.form.prerecorded-set"}}
        </h4>
        <TrackUploader
          @changeset={{changeset}}
          @onStartUpload={{this.onStartUpload}}
          @onFinishUpload={{this.onFinishUpload}}
        />
        {{#if changeset.prerecordTrackId}}
          {{changeset.prerecordTrackFilename}}
        {{/if}}
      {{/if}}
    </section>

    <div class="mb-4">
      <Button
        @type="submit"
        @intent="primary"
        disabled={{(or
          (eq this.isUploading true)
          (or Form.state.hasSubmitted changeset.isInvalid)
        )}}
        class="cool-button mb-2"
      >
        {{t "profile.my-shows.form.update"}}
      </Button>
    </div>
    {{#if
      (or
        (eq this.currentUser.user.username @episode.hostedBy)
        (includes "admin" this.currentUser.user.roles)
      )
    }}
      <div>
        <Button
          @type="submit"
          @intent="danger"
          class="cool-button mb-2 danger"
          {{on "click" this.deleteEpisode}}
        >
          {{t "profile.my-shows.form.delete"}}
        </Button>
      </div>
    {{/if}}
  </Ui::ChangesetForm>
{{/let}}